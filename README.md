# Zeeka Mining Setup

> *The height limit is currently set to: 5000 blocks.* Chaos Testnet started on 20.10.2022

## We have to install 3 elements of mining
### 1. Bazuka
**Prepare**
```
sudo apt-get update && sudo apt-get upgrade
```
```
sudo apt install -y build-essential libssl-dev cmake ocl-icd-opencl-dev -y
```
**Install Rust**

```
sudo curl https://sh.rustup.rs -sSf | sh -s -- -y
```
```
source "$HOME/.cargo/env"
```

***Clone bazuka repo and install***
```
cd
git clone https://github.com/zeeka-network/bazuka
cd bazuka
cargo install --path .
```

**Init bazuka node**
```
bazuka init --seed "your seed phrase" --network chaos --node 127.0.0.1:8765
```
:exclamation: The seed is a random ***unique*** string of characters, not mnemonic phrases. You do not need to generate it using wallets! (E.g Metamask) The longer the seed is, the safer. We suggest a seed string of at least **80 random characters.** Your regular and zero-knowledge private-keys are derived from the `--seed` value, so don't forget to **keep them somewhere safe and do not share it!**

> In case you want to re-init. Remove `.bazuka.yaml`
> ```
> rm ~/.bazuka.yaml
> ```
> Then init again as it shown above

**Create service file for bazuka**
```
sudo tee <<EOF > dev/null /etc/systemd/system/bazuka.service
[Unit]
Description=Bazuka node
After=network.target

[Service]
User=root
ExecStart=/root/.cargo/bin/bazuka node \
 --listen 0.0.0.0:8765 \
 --external YOUR.SERVER.IP.ADDR:8765 \
 --network chaos \
 --db ~/.bazuka-chaos \
 --discord-handle "roguelin#2113" \
 --bootstrap 34.132.176.19:8765
Restart=on-failure
RestartSec=3
LimitNOFILE=65535

[Install]
WantedBy=multi-user.target
```
```
sudo systemctl daemon-reload
sudo systemctl enable bazuka
sudo systemctl restart bazuka
```
**Bazuka logs**
```
journalctl -u bazuka -f -o cat
```

### 2.Zoro - the MPN executor
> Mining on GPU require GPU drivers is installed. You also have to install ocl-icd-opencl-dev! (Currently, only NVIDIA GPUs are supported)

**Install zoro**
```
cd
git clone https://github.com/zeeka-network/zoro
cd zoro
cargo install --path .
```
**Download parameters**    
> **Create dir for params**    
```
mkdir ~/zoro-params
```
- **Payment parameters (~700MB):**
```
wget https://api.rues.info/payment-new.dat -O payment-new.dat
```
- **Update parameters (~6GB):**
```
wget https://api.rues.info/update_params.dat -O update_params.dat
```
**Create service file for zoro.** ***Note*** The *seed phrase for the zoro* needs to be different from the *seed you use for your bazuka node*
```
sudo tee <<EOF > dev/null /etc/systemd/system/zoro.service
[Unit]
Description=Zoro miner
After=network.target

[Service]
User=root
ExecStart=/root/.cargo/bin/zoro --node 127.0.0.1:8765 --seed "fire oak walnut argue half news medal nothing pioneer fall bomb enroll" \
 --network chaos \
 --update-circuit-params /root/zeeka_params/update-new.dat \
 --payment-circuit-params /root/zeeka_params/payment-new.dat \
 --db ~/.bazuka-chaos
Restart=on-failure
RestartSec=3
LimitNOFILE=65535

[Install]
WantedBy=multi-user.target
```
> :exclamation: Add `--gpu` flag in a service file, if you'll mine on GPU    

### 3. Uzi-miner
After a new block is generated by *zoro*, the *uzi-miner* should start working on the PoW puzzle, so we have to install it
```
cd
git clone https://github.com/zeeka-network/uzi-miner
cd uzi-miner
cargo install --path .
```
**Create service file for uzi-miner**
```
sudo tee <<EOF > dev/null /etc/systemd/system/uzi-miner.service
[Unit]
Description=Uzi-miner
After=network.target

[Service]
User=root
ExecStart=/root/.cargo/bin/uzi-miner --node 127.0.0.1:8765 --threads 24
Restart=on-failure
RestartSec=3
LimitNOFILE=65535

[Install]
WantedBy=multi-user.target
```
> *Note:* Change number of `--threads` based on the spec of your system    

**Enable services and start mining**
```
sudo systemctl daemon-reload
sudo systemctl enable zoro uzi-miner
sudo systemctl restart zoro uzi-miner
```


